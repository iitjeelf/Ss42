<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Online Exam</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
    body {
        font-family: Arial, sans-serif;
        background: #f5f5f5;
        padding: 20px;
    }
    .container {
        max-width: 700px;
        margin: auto;
        background: white;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 0 10px #ccc;
    }
    button {
        padding: 10px 20px;
        background: #007bff;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
    }
    button:hover { background: #0056b3; }
    .hidden { display: none; }
</style>
</head>
<body>

<div class="container" id="studentSection">
    <h2>Student Information</h2>

    <label>Name</label>
    <input type="text" id="name" class="form-control" required><br><br>

    <label>Section</label>
    <input type="text" id="section" class="form-control" required><br><br>

    <label>Roll Number</label>
    <input type="text" id="roll" class="form-control" required><br><br>

    <label>Admission Number</label>
    <input type="text" id="admission" class="form-control" required><br><br>

    <button onclick="startExam()">Start Exam</button>
</div>

<div class="container hidden" id="examSection">
    <h2>Exam</h2>

    <div id="questions">
        <h4>1. Capital of India?</h4>
        <input type="radio" name="q1" value="Delhi"> Delhi<br>
        <input type="radio" name="q1" value="Mumbai"> Mumbai<br><br>

        <h4>2. 2 + 2 = ?</h4>
        <input type="radio" name="q2" value="4"> 4<br>
        <input type="radio" name="q2" value="5"> 5<br><br>

        <h4>3. Largest planet?</h4>
        <input type="radio" name="q3" value="Jupiter"> Jupiter<br>
        <input type="radio" name="q3" value="Mars"> Mars<br><br>
    </div>

    <button onclick="submitExam()">Submit Exam</button>
</div>

<div class="container hidden" id="resultSection">
    <h2>Result</h2>
    <p id="resultText"></p>
</div>

<script>
    const correctAnswers = {
        q1: "Delhi",
        q2: "4",
        q3: "Jupiter"
    };

    function startExam() {
        if (!document.getElementById("name").value) return alert("Enter Name");
        if (!document.getElementById("section").value) return alert("Enter Section");
        if (!document.getElementById("roll").value) return alert("Enter Roll Number");
        if (!document.getElementById("admission").value) return alert("Enter Admission Number");

        document.getElementById("studentSection").classList.add("hidden");
        document.getElementById("examSection").classList.remove("hidden");
    }

    function submitExam() {
        let score = 0;
        let answers = {};

        Object.keys(correctAnswers).forEach(q => {
            let selected = document.querySelector(`input[name="${q}"]:checked`);
            answers[q] = selected ? selected.value : "Not answered";

            if (selected && selected.value === correctAnswers[q]) score++;
        });

        let percent = (score / Object.keys(correctAnswers).length) * 100;

        document.getElementById("examSection").classList.add("hidden");
        document.getElementById("resultSection").classList.remove("hidden");

        document.getElementById("resultText").innerHTML =
            `Score: ${score} / 3 <br> Percentage: ${percent.toFixed(2)}%`;

        // SAVE TO GOOGLE SHEET
        submitToSheet(
            document.getElementById("name").value,
            document.getElementById("section").value,
            document.getElementById("roll").value,
            document.getElementById("admission").value,
            JSON.stringify(answers),
            score,
            percent.toFixed(2)
        );
    }

    function submitToSheet(name, section, roll, admission, answers, score, percent) {

        fetch("https://script.google.com/macros/s/AKfycbw1g9mdg7j_DIeejvBELr7Kg9dijY-IwWkZg0qIeVSQrJF9P8D0E3VV2fNESwx8Nwt0/exec", {
            method: "POST",
            body: JSON.stringify({
                name: name,
                section: section,
                roll: roll,
                admission: admission,
                answers: answers,
                score: score,
                percent: percent
            })
        })
        .then(res => res.json())
        .then(data => console.log("Saved:", data))
        .catch(err => console.error("Error:", err));
    }
</script>

</body>
</html>
